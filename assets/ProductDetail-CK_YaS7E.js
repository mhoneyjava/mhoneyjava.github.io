import{a as te,t as $,j as a}from"./index-Du9xPx5n.js";import{e as se,b as ne,r as m,L as C}from"./react-vendor-Dw5DccgK.js";import{u as re,c as K,b as _}from"./useItems-CIeSmGIL.js";import{u as ie,g as oe}from"./useContainers-DzLj7aha.js";import{S as ce}from"./SEO-ByQnIMAX.js";import"./helmet-CAINHZvn.js";function ge(){var M,D,B,H;const{slug:k,id:p}=se(),S=ne(),{items:L,loading:Q}=re(),{containers:W}=ie(),G=p!=null?p:k,e=K(L,G),{addItem:X}=te(),[c,V]=m.useState(0),[j,v]=m.useState(0),[u,N]=m.useState(1),[R,E]=m.useState(""),x=(()=>{if(!e)return[];const t=[];if(e.images&&e.images.length>0&&t.push(...e.images),e.variants&&e.variants.length>0)for(const s of e.variants)s.image&&!t.includes(s.image)&&t.push(s.image);return e.image&&!t.includes(e.image)&&t.push(e.image),t})();if(m.useEffect(()=>{var i,r,n;(i=e==null?void 0:e.variants)!=null&&i[0]&&V(0);const t=_(e!=null?e:{},0),s=x.indexOf(t);v(s>=0?s:0),e&&$("view_item",{item_id:e.id,item_name:e.name,item_category:e.category,item_type:e.type,price:((n=(r=e.variants)==null?void 0:r[0])==null?void 0:n.price)||0})},[e]),m.useEffect(()=>{k&&!p&&e&&S(`/products/${e.id}`,{replace:!0})},[k,p,e,S]),m.useEffect(()=>{var s,i;const t=(i=(s=e==null?void 0:e.variants)==null?void 0:s[c])==null?void 0:i.image;if(t){const r=x.indexOf(t);v(r>=0?r:0)}else{const r=_(e!=null?e:{},c),n=x.indexOf(r);v(n>=0?n:0)}},[c,e]),Q)return a.jsx("div",{className:"max-w-4xl mx-auto px-4 py-10",children:a.jsx("p",{className:"text-stone-700",children:"Memuat produk..."})});if(!e)return a.jsx("div",{className:"max-w-4xl mx-auto px-4 py-10",children:a.jsx("p",{className:"text-stone-700",children:"Produk tidak ditemukan."})});const Y=()=>{var s,i,r,n;const t=e.variants[c];X({type:e.type,id:e.id,name:e.type==="hamper"?`Hampers: ${e.name}`:e.name,variant:t.name,price:t.price,qty:u,description:R||void 0,image:(n=(r=(i=t.image)!=null?i:(s=e.images)==null?void 0:s[j])!=null?r:e.image)!=null?n:"/logo.svg"}),$("add_to_cart",{item_id:e.id,item_name:e.name,item_category:e.category,item_type:e.type,item_variant:t.name,price:t.price,quantity:u,value:t.price*u,currency:"IDR"}),N(1),E("")},P=e.variants[c],o=e.type==="honey";return a.jsxs(a.Fragment,{children:[a.jsx(ce,{title:e.name,description:e.description,keywords:`${e.name}, ${e.type==="honey"?"madu murni, madu asli, MHoney":"hampers premium, paket hadiah, Sundakawa"}, ${((M=e.tags)!=null?M:[]).join(", ")}`,url:o?`/products/${e.slug}`:`/sundakawa/catalogue/${e.slug}`,image:(B=(D=e.images)==null?void 0:D[0])!=null?B:e.image,type:"product",productName:e.name,productPrice:P.price,productCurrency:"IDR",productAvailability:"InStock",productCategory:e.category,breadcrumbs:[{name:"Home",url:"/"},{name:o?"Produk":"Sundakawa",url:o?"/products":"/sundakawa/catalogue"},{name:e.name,url:o?`/products/${e.slug}`:`/sundakawa/catalogue/${e.slug}`}]}),a.jsxs("div",{className:"max-w-6xl mx-auto px-4 grid md:grid-cols-2 gap-8",children:[a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx("div",{className:`rounded-xl overflow-hidden flex items-center justify-center aspect-square ${o?"bg-amber-50":"bg-green-50"}`,children:a.jsx("img",{loading:"lazy",src:(H=x[j])!=null?H:_(e,c),alt:`${e.name} - gambar ${j+1}`,className:"w-full h-full object-contain object-center"})}),x.length>1&&a.jsx("div",{className:"flex gap-2 overflow-x-auto",children:x.map((t,s)=>a.jsx("button",{className:`rounded-lg border ${s===j?"border-amber-600 ring-2 ring-amber-300":"border-stone-200"} p-1`,onClick:()=>v(s),"aria-label":`Pilih gambar ${s+1}`,children:a.jsx("img",{loading:"lazy",src:t,alt:`${e.name} - thumb ${s+1}`,className:"h-16 w-16 object-contain"})},`thumb-${s}`))})]}),a.jsxs("div",{className:"py-2",children:[a.jsx("nav",{"aria-label":"Breadcrumb",className:"mb-3 text-sm text-stone-600",children:a.jsxs("ol",{className:"flex items-center gap-2",children:[a.jsx("li",{children:a.jsx(C,{to:"/",className:"hover:underline",children:"Beranda"})}),a.jsx("li",{children:a.jsx("span",{"aria-hidden":"true",children:"/"})}),a.jsx("li",{children:a.jsx(C,{to:o?"/products":"/sundakawa/catalogue",className:"hover:underline",children:o?"Produk":"Sundakawa"})}),a.jsx("li",{children:a.jsx("span",{"aria-hidden":"true",children:"/"})}),a.jsx("li",{children:a.jsx("span",{className:"text-stone-900 font-medium","aria-current":"page",children:e.name})})]})}),a.jsx("div",{className:"flex items-center gap-2 mb-2",children:a.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded-full ${o?"bg-amber-100 text-amber-800":"bg-green-100 text-green-800"}`,children:o?"MHoney":"Sundakawa"})}),a.jsx("h1",{className:"text-3xl font-semibold text-stone-900",children:e.name}),a.jsx("p",{className:"text-stone-700 mt-2",children:e.description}),e.tags&&e.tags.length>0&&a.jsx("ul",{className:"flex flex-wrap gap-2 mt-3 text-sm text-stone-700",children:e.tags.map(t=>a.jsx("li",{className:"rounded-full bg-stone-100 border border-stone-200 px-3 py-1",children:t},t))}),e.includes&&e.includes.length>0&&a.jsxs("div",{className:"mt-4",children:[a.jsx("h2",{className:"font-semibold text-stone-900",children:"Isi Paket"}),a.jsx("ul",{className:"list-disc pl-6 text-stone-700 mt-2",children:e.includes.reduce((t,s,i)=>((s||"").split(",").map(n=>n.trim()).filter(Boolean).forEach((n,g)=>{var T,z;const d=n.match(/^\s*(\d+)\s*\*\s*(.+)$/),h=d?Number(d[1]):1,y=d?d[2]:n,[w,b]=(y||"").split(":"),Z=(w||"").trim(),f=(b||"").trim(),l=K(L,Z);if(!l){t.push(a.jsx("li",{children:n},`${s}-${g}`));return}let O=0;if(f){const A=((T=l.variants)!=null?T:[]).findIndex(I=>{var U,F,J;return((U=I.name)!=null?U:"").toLowerCase()===f.toLowerCase()||((F=I.name)!=null?F:"").toLowerCase().includes(f.toLowerCase())||f.toLowerCase().includes(((J=I.name)!=null?J:"").toLowerCase())});A>=0&&(O=A)}const q=(z=l.variants)==null?void 0:z[O],ee=l.type==="honey"?`/products/${l.slug}`:`/sundakawa/catalogue/${l.slug}`,ae=l.available==="unlisted";t.push(a.jsxs("li",{children:[ae?a.jsx("span",{className:"text-stone-700",children:l.name}):a.jsx(C,{to:ee,className:"text-green-700 hover:underline",children:l.name}),f&&q&&a.jsxs("span",{className:"text-stone-600",children:[" — ",q.name]}),h>1&&a.jsxs("span",{className:"text-stone-600",children:["  ×",h]})]},`${s}-${g}`))}),t),[])})]}),e.container&&a.jsxs("div",{className:"mt-4",children:[a.jsx("h2",{className:"font-semibold text-stone-900",children:"Wadah"}),a.jsx("div",{className:"mt-2 text-stone-700",children:(()=>{var h,y;const[t,s]=(e.container||"").split(":"),i=(t||"").trim(),r=(s||"").trim(),n=oe(W,i);if(!n)return a.jsx("span",{children:e.container});let g=0;if(r){const w=((h=n.variants)!=null?h:[]).findIndex(b=>(b.name||"").toLowerCase()===r.toLowerCase()||(b.name||"").toLowerCase().includes(r.toLowerCase())||r.toLowerCase().includes((b.name||"").toLowerCase()));w>=0&&(g=w)}const d=(y=n.variants)==null?void 0:y[g];return a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:n.name}),r&&d&&a.jsx("div",{className:"text-sm text-stone-600",children:d.name})]})})})()})]}),e.variants.length>1&&a.jsxs("div",{className:"mt-6",children:[a.jsx("label",{className:"block text-sm font-medium text-stone-800",children:o?"Ukuran":"Varian"}),a.jsx("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-4 gap-2",children:e.variants.map((t,s)=>a.jsxs("button",{onClick:()=>{const i=e.variants[c];V(s),s!==c&&$("select_product_variant",{item_id:e.id,item_name:e.name,from_variant:i.name,to_variant:t.name,from_price:i.price,to_price:t.price,price_difference:t.price-i.price})},className:`rounded-lg px-3 py-2 border ${s===c?`border-${o?"amber":"green"}-600 bg-${o?"amber":"green"}-50 text-${o?"amber":"green"}-900`:"border-stone-300 bg-white text-stone-800 hover:border-stone-400"}`,children:[a.jsx("div",{className:"font-medium",children:t.name}),a.jsxs("div",{className:"text-xs mt-1",children:["Rp ",t.price.toLocaleString("id-ID")]})]},t.name))})]}),a.jsx("div",{className:"mt-6",children:a.jsxs("div",{className:"text-2xl font-bold text-stone-900",children:["Rp ",P.price.toLocaleString("id-ID")]})}),a.jsxs("div",{className:"mt-6",children:[a.jsx("label",{className:"block text-sm font-medium text-stone-800 mb-2",children:"Jumlah"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:()=>N(Math.max(1,u-1)),className:"w-10 h-10 rounded-lg border border-stone-300 bg-white hover:bg-stone-50 flex items-center justify-center font-semibold text-stone-700",children:"−"}),a.jsx("input",{type:"number",min:"1",value:u,onChange:t=>N(Math.max(1,Number(t.target.value)||1)),className:"w-20 h-10 rounded-lg border border-stone-300 px-3 text-center font-medium"}),a.jsx("button",{onClick:()=>N(u+1),className:"w-10 h-10 rounded-lg border border-stone-300 bg-white hover:bg-stone-50 flex items-center justify-center font-semibold text-stone-700",children:"+"})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-stone-800 mb-1.5",children:"Tambahkan Deskripsi"}),a.jsx("textarea",{value:R,onChange:t=>E(t.target.value),rows:2,placeholder:"Tambahkan catatan (seperti tulisan pada kartu ucapan atau request khusus lainnya) untuk produk ini (opsional)",className:"w-full rounded-lg border border-stone-300 px-3 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent transition-all resize-none"})]}),a.jsx("div",{className:"mt-6 flex gap-3",children:a.jsx("button",{onClick:Y,className:`rounded-lg text-white px-6 py-3 font-medium ${o?"bg-amber-700 hover:bg-amber-800":"bg-green-700 hover:bg-green-800"}`,children:"Tambah ke Keranjang"})})]})]})]})}export{ge as default};
