import{a as se,t as I,j as a}from"./index-BPWaEDI-.js";import{e as ne,b as re,r as m,L as $}from"./react-vendor-Dw5DccgK.js";import{u as ie,c as K,b as C}from"./useItems-DMvVveWL.js";import{u as oe,g as ce}from"./useContainers-DRFRk47N.js";import{S as le}from"./SEO-gMbXW5DO.js";import"./helmet-CAINHZvn.js";function he(){var P,q,D,B;const{slug:w,id:p}=ne(),_=re(),{items:S,loading:Q}=ie(),{containers:W}=oe(),G=p!=null?p:w,e=K(S,G),{addItem:X}=se(),[c,Y]=m.useState(()=>{var t;return(t=e==null?void 0:e.variants)!=null&&t[0],0}),[j,L]=m.useState(()=>{if(!e)return 0;const t=C(e,0),s=[];if(e.images&&e.images.length>0&&s.push(...e.images),e.variants&&e.variants.length>0)for(const n of e.variants)n.image&&!s.includes(n.image)&&s.push(n.image);e.image&&!s.includes(e.image)&&s.push(e.image);const i=s.indexOf(t);return i>=0?i:0}),[u,v]=m.useState(1),[V,R]=m.useState(""),x=(()=>{if(!e)return[];const t=[];if(e.images&&e.images.length>0&&t.push(...e.images),e.variants&&e.variants.length>0)for(const s of e.variants)s.image&&!t.includes(s.image)&&t.push(s.image);return e.image&&!t.includes(e.image)&&t.push(e.image),t})();m.useEffect(()=>{var t,s;e&&I("view_item",{item_id:e.id,item_name:e.name,item_category:e.category,item_type:e.type,price:((s=(t=e.variants)==null?void 0:t[0])==null?void 0:s.price)||0})},[e]),m.useEffect(()=>{w&&!p&&e&&_(`/products/${e.id}`,{replace:!0})},[w,p,e,_]);const E=m.useMemo(()=>{var s,i;const t=(i=(s=e==null?void 0:e.variants)==null?void 0:s[c])==null?void 0:i.image;if(t){const n=x.indexOf(t);return n>=0?n:0}else{const n=C(e!=null?e:{},c),r=x.indexOf(n);return r>=0?r:0}},[c,e,x]);if(m.useEffect(()=>{L(E)},[E]),Q)return a.jsx("div",{className:"max-w-4xl mx-auto px-4 py-10 flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block w-8 h-8 border-4 border-gray-300 border-t-amber-600 rounded-full animate-spin"}),a.jsx("p",{className:"mt-4 text-stone-600",children:"Memuat produk..."})]})});if(!e)return a.jsx("div",{className:"max-w-4xl mx-auto px-4 py-10",children:a.jsx("p",{className:"text-stone-700",children:"Produk tidak ditemukan."})});const Z=()=>{var s,i,n,r;const t=e.variants[c];X({type:e.type,id:e.id,name:e.type==="hamper"?`Hampers: ${e.name}`:e.name,variant:t.name,price:t.price,qty:u,description:V||void 0,image:(r=(n=(i=t.image)!=null?i:(s=e.images)==null?void 0:s[j])!=null?n:e.image)!=null?r:"/logo.svg"}),I("add_to_cart",{item_id:e.id,item_name:e.name,item_category:e.category,item_type:e.type,item_variant:t.name,price:t.price,quantity:u,value:t.price*u,currency:"IDR"}),v(1),R("")},M=e.variants[c],o=e.type==="honey";return a.jsxs(a.Fragment,{children:[a.jsx(le,{title:e.name,description:e.description,keywords:`${e.name}, ${e.type==="honey"?"madu murni, madu asli, MHoney":"hampers premium, paket hadiah, Sundakawa"}, ${((P=e.tags)!=null?P:[]).join(", ")}`,url:o?`/products/${e.slug}`:`/sundakawa/catalogue/${e.slug}`,image:(D=(q=e.images)==null?void 0:q[0])!=null?D:e.image,type:"product",productName:e.name,productPrice:M.price,productCurrency:"IDR",productAvailability:"InStock",productCategory:e.category,breadcrumbs:[{name:"Home",url:"/"},{name:o?"Produk":"Sundakawa",url:o?"/products":"/sundakawa/catalogue"},{name:e.name,url:o?`/products/${e.slug}`:`/sundakawa/catalogue/${e.slug}`}]}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 grid md:grid-cols-2 gap-8",children:[a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx("div",{className:`rounded-xl overflow-hidden flex items-center justify-center aspect-square ${o?"bg-amber-50":"bg-green-50"}`,children:a.jsx("img",{loading:"lazy",src:(B=x[j])!=null?B:C(e,c),alt:`${e.name} - gambar ${j+1}`,className:"w-full h-full object-contain object-center"})}),x.length>1&&a.jsx("div",{className:"flex gap-2 overflow-x-auto",children:x.map((t,s)=>a.jsx("button",{className:`rounded-lg border ${s===j?"border-amber-600 ring-2 ring-amber-300":"border-stone-200"} p-1`,onClick:()=>L(s),"aria-label":`Pilih gambar ${s+1}`,children:a.jsx("img",{loading:"lazy",src:t,alt:`${e.name} - thumb ${s+1}`,className:"h-16 w-16 object-contain"})},`thumb-${s}`))})]}),a.jsxs("div",{className:"py-2",children:[a.jsx("nav",{"aria-label":"Breadcrumb",className:"mb-3 text-sm text-stone-600",children:a.jsxs("ol",{className:"flex items-center gap-2",children:[a.jsx("li",{children:a.jsx($,{to:"/",className:"hover:underline",children:"Beranda"})}),a.jsx("li",{children:a.jsx("span",{"aria-hidden":"true",children:"/"})}),a.jsx("li",{children:a.jsx($,{to:o?"/products":"/sundakawa/catalogue",className:"hover:underline",children:o?"Produk":"Sundakawa"})}),a.jsx("li",{children:a.jsx("span",{"aria-hidden":"true",children:"/"})}),a.jsx("li",{children:a.jsx("span",{className:"text-stone-900 font-medium","aria-current":"page",children:e.name})})]})}),a.jsx("div",{className:"flex items-center gap-2 mb-2",children:a.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded-full ${o?"bg-amber-100 text-amber-800":"bg-green-100 text-green-800"}`,children:o?"MHoney":"Sundakawa"})}),a.jsx("h1",{className:"text-3xl font-semibold text-stone-900",children:e.name}),a.jsx("p",{className:"text-stone-700 mt-2",children:e.description}),e.tags&&e.tags.length>0&&a.jsx("ul",{className:"flex flex-wrap gap-2 mt-3 text-sm text-stone-700",children:e.tags.map(t=>a.jsx("li",{className:"rounded-full bg-stone-100 border border-stone-200 px-3 py-1",children:t},t))}),e.includes&&e.includes.length>0&&a.jsxs("div",{className:"mt-4",children:[a.jsx("h2",{className:"font-semibold text-stone-900",children:"Isi Paket"}),a.jsx("ul",{className:"list-disc pl-6 text-stone-700 mt-2",children:e.includes.reduce((t,s,i)=>((s||"").split(",").map(r=>r.trim()).filter(Boolean).forEach((r,g)=>{var T,z;const d=r.match(/^\s*(\d+)\s*\*\s*(.+)$/),h=d?Number(d[1]):1,N=d?d[2]:r,[y,f]=(N||"").split(":"),ee=(y||"").trim(),b=(f||"").trim(),l=K(S,ee);if(!l){t.push(a.jsx("li",{children:r},`${s}-${g}`));return}let H=0;if(b){const F=((T=l.variants)!=null?T:[]).findIndex(k=>{var A,U,J;return((A=k.name)!=null?A:"").toLowerCase()===b.toLowerCase()||((U=k.name)!=null?U:"").toLowerCase().includes(b.toLowerCase())||b.toLowerCase().includes(((J=k.name)!=null?J:"").toLowerCase())});F>=0&&(H=F)}const O=(z=l.variants)==null?void 0:z[H],ae=l.type==="honey"?`/products/${l.slug}`:`/sundakawa/catalogue/${l.slug}`,te=l.available==="unlisted";t.push(a.jsxs("li",{children:[te?a.jsx("span",{className:"text-stone-700",children:l.name}):a.jsx($,{to:ae,className:"text-green-700 hover:underline",children:l.name}),b&&O&&a.jsxs("span",{className:"text-stone-600",children:[" — ",O.name]}),h>1&&a.jsxs("span",{className:"text-stone-600",children:["  ×",h]})]},`${s}-${g}`))}),t),[])})]}),e.container&&a.jsxs("div",{className:"mt-4",children:[a.jsx("h2",{className:"font-semibold text-stone-900",children:"Wadah"}),a.jsx("div",{className:"mt-2 text-stone-700",children:(()=>{var h,N;const[t,s]=(e.container||"").split(":"),i=(t||"").trim(),n=(s||"").trim(),r=ce(W,i);if(!r)return a.jsx("span",{children:e.container});let g=0;if(n){const y=((h=r.variants)!=null?h:[]).findIndex(f=>(f.name||"").toLowerCase()===n.toLowerCase()||(f.name||"").toLowerCase().includes(n.toLowerCase())||n.toLowerCase().includes((f.name||"").toLowerCase()));y>=0&&(g=y)}const d=(N=r.variants)==null?void 0:N[g];return a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:r.name}),n&&d&&a.jsx("div",{className:"text-sm text-stone-600",children:d.name})]})})})()})]}),e.variants.length>1&&a.jsxs("div",{className:"mt-6",children:[a.jsx("label",{className:"block text-sm font-medium text-stone-800",children:o?"Ukuran":"Varian"}),a.jsx("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-4 gap-2",children:e.variants.map((t,s)=>a.jsxs("button",{onClick:()=>{const i=e.variants[c];Y(s),s!==c&&I("select_product_variant",{item_id:e.id,item_name:e.name,from_variant:i.name,to_variant:t.name,from_price:i.price,to_price:t.price,price_difference:t.price-i.price})},className:`rounded-lg px-3 py-2 border ${s===c?`border-${o?"amber":"green"}-600 bg-${o?"amber":"green"}-50 text-${o?"amber":"green"}-900`:"border-stone-300 bg-white text-stone-800 hover:border-stone-400"}`,children:[a.jsx("div",{className:"font-medium",children:t.name}),a.jsxs("div",{className:"text-xs mt-1",children:["Rp ",t.price.toLocaleString("id-ID")]})]},t.name))})]}),a.jsx("div",{className:"mt-6",children:a.jsxs("div",{className:"text-2xl font-bold text-stone-900",children:["Rp ",M.price.toLocaleString("id-ID")]})}),a.jsxs("div",{className:"mt-6",children:[a.jsx("label",{htmlFor:"product-qty-input",className:"block text-sm font-medium text-stone-800 mb-2",children:"Jumlah"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:()=>v(Math.max(1,u-1)),className:"w-10 h-10 rounded-lg border border-stone-300 bg-white hover:bg-stone-50 flex items-center justify-center font-semibold text-stone-700",children:"−"}),a.jsx("input",{id:"product-qty-input",type:"number",min:"1",value:u,onChange:t=>v(Math.max(1,Number(t.target.value)||1)),className:"w-20 h-10 rounded-lg border border-stone-300 px-3 text-center font-medium"}),a.jsx("button",{onClick:()=>v(u+1),className:"w-10 h-10 rounded-lg border border-stone-300 bg-white hover:bg-stone-50 flex items-center justify-center font-semibold text-stone-700",children:"+"})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("label",{htmlFor:"product-note-textarea",className:"block text-sm font-medium text-stone-800 mb-1.5",children:"Tambahkan Deskripsi"}),a.jsx("textarea",{id:"product-note-textarea",value:V,onChange:t=>R(t.target.value),rows:2,placeholder:"Tambahkan catatan (seperti tulisan pada kartu ucapan atau request khusus lainnya) untuk produk ini (opsional)",className:"w-full rounded-lg border border-stone-300 px-3 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent transition-all resize-none"})]}),a.jsx("div",{className:"mt-6 flex gap-3",children:a.jsx("button",{onClick:Z,className:`rounded-lg text-white px-6 py-3 font-medium ${o?"bg-amber-700 hover:bg-amber-800":"bg-green-700 hover:bg-green-800"}`,children:"Tambah ke Keranjang"})})]})]})]})}export{he as default};
